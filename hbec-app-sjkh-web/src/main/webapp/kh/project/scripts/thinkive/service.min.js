define(function(require,exports,module){var e=jQuery=require("jquery");var r=require("gconfig");var t=r.platform;var o=require("appUtils");require("domain");e.extend(e.domain,{Service:i});function i(){this.reqDic={};this.callBackDic={}}i.prototype.invoke=function(e,r){var i=this;var a=e.getProtocol();var s=e.getFlowNo();var c=e.getUrl();var n=e.getReqParam();var l=e.getIsLastReq();var v=e.getIsAsync();var f=e.getIsShowWait();var u=e.getIsShowOverLay();var g=e.getTipsWords();var p=e.getTimeOutFunc();var d=e.getDataType();n.clientinfo=o.getSStorageInfo("clientinfo");n.jsessionid=o.getSStorageInfo("jsessionid");if(t=="0"){n.op_way=n.op_source=0}else if(t=="1"){if(iBrowser.android){n.op_way=n.op_source=3}else{n.op_way=n.op_source=2}}else if(iBrowser.iPhone||iBrowser.iPad){n.op_way=n.op_source=3}i.reqDic[s]=e;i.callBackDic[s]=r;o.invokeServer(c,n,r,l,v,f,u,g,p,d)};i.prototype.onResult=function(r,t){var o=this.callBackDic[r];if(o!=null){delete this.callBackDic[r]}var i=this.reqDic[r];delete this.reqDic[r];var a=new e.domain.ResultVo;a.setErrorNo(t["error_no"]);a.setErrorInfo(t["error_info"]);if(e.string.isEmpty(a.getErrorNo())){a.setErrorNo("0")}var s=t["dsName"];var c={};if(s&&s.length>0){for(var n=0;n<s.length;n++){var l=s[n];c[l]=t[l]}}else{c["results"]=t["results"];s=["results"]}a.setDsName(s);a.setResults(c);a.setResultHeaders(t["fields"]);a.setReqParamVo(i);if(o!=null){o(a)}};i.prototype.clearRequest=function(e,r){require.async(e,function(module){})};i.prototype.destroy=function(){for(var e in this.callBackDic){delete this.callBackDic[e]}for(var e in this.reqDic){var r=this.reqDic[e];var t=r.getProtocol();this.clearRequest(t,e);delete this.reqDic[e]}for(var e in seajs.cache){if(e.indexOf("_async_"+seajs._asyncNum)>-1){delete seajs.cache[e]}}}});