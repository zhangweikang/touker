define(function(d,c,e){var g=jQuery=d("jquery");var f=d("gconfig");var a=f.platform;var b=d("appUtils");d("domain");g.extend(g.domain,{Service:h});function h(){this.reqDic={};this.callBackDic={}}h.prototype.invoke=function(i,s){var l=this;var u=i.getProtocol();var r=i.getFlowNo();var j=i.getUrl();var o=i.getReqParam();var n=i.getIsLastReq();var m=i.getIsAsync();var t=i.getIsShowWait();var k=i.getIsShowOverLay();var q=i.getTipsWords();var v=i.getTimeOutFunc();var p=i.getDataType();o.clientinfo=b.getSStorageInfo("clientinfo");o.jsessionid=b.getSStorageInfo("jsessionid");if(a=="0"){o.op_way=o.op_source=0}else{if(a=="1"){if(iBrowser.android){o.op_way=o.op_source=3}else{o.op_way=o.op_source=2}}else{if(iBrowser.iPhone||iBrowser.iPad){o.op_way=o.op_source=3}}}l.reqDic[r]=i;l.callBackDic[r]=s;b.invokeServer(j,o,s,n,m,t,k,q,v,p)};h.prototype.onResult=function(p,r){var q=this.callBackDic[p];if(q!=null){delete this.callBackDic[p]}var k=this.reqDic[p];delete this.reqDic[p];var n=new g.domain.ResultVo();n.setErrorNo(r.error_no);n.setErrorInfo(r.error_info);if(g.string.isEmpty(n.getErrorNo())){n.setErrorNo("0")}var l=r.dsName;var j={};if(l&&l.length>0){for(var m=0;m<l.length;m++){var o=l[m];j[o]=r[o]}}else{j.results=r.results;l=["results"]}n.setDsName(l);n.setResults(j);n.setResultHeaders(r.fields);n.setReqParamVo(k);if(q!=null){q(n)}};h.prototype.clearRequest=function(j,i){d.async(j,function(k){})};h.prototype.destroy=function(){for(var i in this.callBackDic){delete this.callBackDic[i]}for(var i in this.reqDic){var j=this.reqDic[i];var k=j.getProtocol();this.clearRequest(k,i);delete this.reqDic[i]}for(var i in seajs.cache){if(i.indexOf("_async_"+seajs._asyncNum)>-1){delete seajs.cache[i]}}}});